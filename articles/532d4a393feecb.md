---
title: "async/awaitã§å‡¦ç†ã‚’é †ç•ªé€šã‚Šã«å‡ºã—ãŸã„æ™‚ã®æ›¸ãæ–¹"
emoji: "ğŸ‘¹"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["JavaScript","éåŒæœŸ"]
published: true
---

èª¬æ˜ã¯ã»ã¨ã‚“ã©ãªã„ã§ã™ã€‚æ›¸ãæ–¹ã‚’ã¿ã¦æ„Ÿã˜ã¦ãã ã•ã„ã€‚ğŸ‘¹
# äº‹å‰çŸ¥è­˜
å…¨éƒ¨åŒã˜çµæœã«ãªã‚‹
## ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã‚’ä½¿ã†setTimeout

```js
setTimeout( function(){ console.log(3) } ,1000 );
setTimeout( function(){ console.log(2) } ,2000 );
setTimeout( function(){ console.log(1) } ,3000 );
```

```js
setTimeout( () => console.log(3) ,1000 );
setTimeout( () => console.log(2) ,2000 );
setTimeout( () => console.log(1) ,3000 );
```

## ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯åœ°ç„

```js
setTimeout( function() {
  console.log(3);
  setTimeout( function() {
    console.log(2);
    setTimeout( function(){
      console.log(1);
    },1000);
  },1000);
} ,1000);
```

```js
setTimeout( function() { console.log(3);
  setTimeout( function() { console.log(2);
    setTimeout( function(){ console.log(1); },1000); },1000); } ,1000);
```

```js
setTimeout( () => {
  console.log(3);
  setTimeout( () => {
    console.log(2);
    setTimeout( () => {
      console.log(1);
    },1000);
  },1000);
} ,1000);
```

## Promise

```js
new Promise(resolve => {
  setTimeout(() => {
    console.log(3);
    resolve();
  },1000);
}).then(() => {
  return new Promise(resolve => {
    setTimeout(() => {
      console.log(2);
      resolve();
    },1000)
  });
}).then(() => {
  return new Promise(resolve => {
    setTimeout(() => {
      console.log(1);
      resolve();
    },1000)
  });
});
```

## async/await

```js
func = async() => {
  await log(3);
  await log(2);
  await log(1);
}

log = (num) => {
  return new Promise(resolve => {
    setTimeout(()=>{
      console.log(num);
      resolve();
    },1000)
  });
}

func();
```

# æœ¬é¡Œ
äºŒã¤ã®å‡¦ç†ã®é †ç•ªã‚’å¤‰ãˆã‚‹

## éåŒæœŸã«å‡¦ç†ã•ã‚Œã‚‹
```js
function lightTask() {
  console.log("HIRO.ã§ã™ã€‚");
}
 
function heavyTask() {
  const procedure = () => {
    console.log("åƒ•ã®åå‰ã¯");
  }
  setTimeout(procedure, 1000);
}
 
function sample() {
  heavyTask();
  lightTask();
}
 
sample();
```

## é †ç•ªã«å‡¦ç†ã•ã‚Œã‚‹
```js
function lightTask() {
  console.log("HIRO.ã§ã™ã€‚");
}

function heavyTask() {

  return new Promise((resolve) => {//Promiseå‹ã‚’è¿”ã™

    function procedure() {
      console.log("åƒ•ã®åå‰ã¯");
      resolve();
    }

    setTimeout(procedure, 1000);

  });

}

async function sample() {
  await heavyTask();
  lightTask();
}

sample();
```
- awaitã§å‘¼ã³å‡ºã•ã‚Œã‚‹é–¢æ•°ã§ã¯promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã™å¿…è¦ãŒã‚ã‚‹
- returnã§ã¯ãªãresolveã§æˆ»ã™ï¼ˆã“ã‚Œã‚’å¿˜ã‚Œã‚‹ã¨åˆ¶å¾¡ãŒæˆ»ã‚‰ãªã„ï¼‰
- awaitã‚’ä½¿ç”¨ã™ã‚‹é–¢æ•°ã«ã¯asyncã‚’ã¤ã‘ã‚‹
- awaitã§å‘¼ã³å‡ºã™ã“ã¨ã§å‡¦ç†ãŒçµ‚ã‚ã‚‹ã¾ã§å¾…ã¤

## thenãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã†
```js
function lightTask() {
  console.log("HIRO.ã§ã™ã€‚");
}

function heavyTask() {

  return new Promise((resolve) => {//Promiseå‹ã‚’è¿”ã™

    function procedure() {
      resolve("åƒ•ã®åå‰ã¯");
    }

    setTimeout(procedure, 1000);

  });

}

async function sample() {
  await heavyTask().then(
    (value)=>{console.log(value);}//heavyTaskãŒçµ‚ã‚ã£ã¦ã‹ã‚‰ã˜ã‚ƒãªã„ã¨console.logã¯è¡¨ç¤ºã•ã‚Œãªã„
  );
  lightTask();
}

sample();
```